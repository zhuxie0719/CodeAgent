<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ·±åº¦åˆ†ææŠ¥å‘Š</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .header .back-btn {
            position: absolute;
            top: 30px;
            left: 30px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .header .back-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .main-content {
            padding: 40px;
        }

        /* CodeAnalysisAgentä¸“å±åˆ†æåŒºåŸŸ */
        .code-analysis-info {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .code-analysis-header {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .code-analysis-icon {
            font-size: 2em;
            color: white;
        }

        .code-analysis-title {
            color: white;
            font-size: 1.5em;
            font-weight: bold;
        }

        .code-analysis-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 25px;
        }

        .analysis-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .analysis-section h3 {
            color: #333;
            font-size: 1.2em;
            margin-bottom: 15px;
            border-bottom: 2px solid #38ef7d;
            padding-bottom: 8px;
        }

        .analysis-item {
            margin-bottom: 12px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #38ef7d;
        }

        .analysis-item-label {
            font-weight: bold;
            color: #555;
            font-size: 0.9em;
        }

        .analysis-item-value {
            color: #333;
            margin-top: 4px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .metric-item {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
        }

        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* æ¦‚è§ˆå¡ç‰‡ */
        .overview-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap:  quarterly;
            margin-bottom: 40px;
        }

        .overview-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .overview-card i {
            font-size: 2.5em;
            margin-bottom: 15px;
            opacity: 0.8;
        }

        .overview-card h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .overview-card .value {
            font-size: 2.2em;
            font-weight: bold;
            margin: 10px 0;
        }

        .overview-card .label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* è¯¦ç»†ä¿¡æ¯åŒºåŸŸ */
        .detail-sections {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .detail-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .detail-section h3 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-section h3 i {
            color: #4facfe;
        }

        /* ä»£ç å¤æ‚åº¦åˆ†æ */
        .complexity-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .complexity-item:last-child {
            border-bottom: none;
        }

        .complexity-label {
            font-weight: 500;
            color: #343a40;
        }

        .complexity-value {
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .complexity-high {
            background: #f8d7da;
            color: #721c24;
        }

        .complexity-medium {
            background: #fff3cd;
            color: #856404;
        }

        .complexity-low {
            background: #d4edda;
            color: #155724;
        }

        /* æ¶æ„åˆ†æ */
        .architecture-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #4facfe;
        }

        .architecture-item .title {
            font-weight: bold;
            color: #343a40;
            margin-bottom: 5px;
        }

        .architecture-item .description {
            color: #6c757d;
            font-size: 0.95em;
            line-height: 1.5;
        }

        /* AIæŠ¥å‘ŠåŒºåŸŸ */
        .ai-report-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .ai-report-section h2 {
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
        }

        .ai-report-content {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .ai-report-content pre {
            white-space: pre-wrap;
            font-family: inherit;
            line-height: 1.6;
            font-size: 1em;
        }

        /* æ€§èƒ½åˆ†æ */
        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .metric-card .score {
            font-size: 1.8em;
            font-weight: bold;
            color: #4facfe;
            margin-bottom: 5px;
        }

        .metric-card .label {
            font-size: 0.9em;
            color: #6c757d;
        }

        /* æ”¹è¿›å»ºè®® */
        .suggestions-list {
            list-style: none;
        }

        .suggestions-list li {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #28a745;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .suggestions-list li i {
            color: #28a745;
            font-size: 1.2em;
        }

        /* å·¥å…·æ  */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .toolbar h2 {
            color: #495057;
            margin: 0;
        }

        .toolbar .actions {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .detail-sections {
                grid-template-columns: 1fr;
            }
            
            .overview-cards {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <div class="header">
            <a href="index.html" class="back-btn">
                <i class="fas fa-arrow-left"></i> è¿”å›
            </a>
            <h1>ğŸ§  AIæ·±åº¦åˆ†ææŠ¥å‘Š</h1>
            <p>æ™ºèƒ½ä»£ç åˆ†æ Â· æ¶æ„è¯„ä¼° Â· æ€§èƒ½æ´å¯Ÿ</p>
        </div>

        <div class="main-content">
            <!-- åŠ è½½çŠ¶æ€ -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div>æ­£åœ¨åŠ è½½æ·±åº¦åˆ†ææŠ¥å‘Š...</div>
            </div>

            <!-- ä¸»è¦å†…å®¹ -->
            <div id="mainContent" style="display: none;">
                <!-- å·¥å…·æ  -->
                <div class="toolbar">
                    <h2><i class="fas fa-file-alt"></i> <span id="fileName">ä»£ç æ–‡ä»¶</span> - AIæ·±åº¦åˆ†æ</h2>
                    <div class="actions">
                        <a href="#" class="btn btn-primary" onclick="downloadReport()">
                            <i class="fas fa-download"></i> ä¸‹è½½æŠ¥å‘Š
                        </a>
                        <a href="#" class="btn btn-success" onclick="viewRawData()">
                            <i class="fas fa-code"></i> åŸå§‹æ•°æ®
                        </a>
                    </div>
                </div>

                <!-- æ¦‚è§ˆå¡ç‰‡ -->
                <div class="overview-cards" id="overviewCards">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- CodeAnalysisAgentä¸“å±åˆ†æåŒºåŸŸ -->
                <div class="code-analysis-info" id="codeAnalysisInfo">
                    <div class="code-analysis-header">
                        <i class="fas fa-robot code-analysis-icon"></i>
                        <div class="code-analysis-title">CodeAnalysisAgentä¸“ä¸šåˆ†æ</div>
                    </div>
                    <div class="code-analysis-content">
                        <!-- é¡¹ç›®æ„å›¾åˆ†æ -->
                        <div class="analysis-section">
                            <h3><i class="fas fa-bullseye"></i> é¡¹ç›®æ„å›¾åˆ†æ</h3>
                            <div id="projectIntentAnalysis">
                                <!-- å°†ç”±JavaScriptå¡«å…… -->
                            </div>
                        </div>
                        
                        <!-- é¡¹ç›®ç»“æ„åˆ†æ -->
                        <div class="analysis-section">
                            <h3><i class="fas fa-sitemap"></i> é¡¹ç›®ç»“æ„åˆ†æ</h3>
                            <div id="projectStructureAnalysis">
                                <!-- å°†ç”±JavaScriptå¡«å…… -->
                            </div>
                            <div class="metrics-grid" id="structureMetrics">
                                <!-- ç»“æ„æŒ‡æ ‡å¡ç‰‡ -->
                            </div>
                        </div>
                        
                        <!-- ä¾èµ–å…³ç³»åˆ†æ -->
                        <div class="analysis-section">
                            <h3><i class="fas fa-network-wired"></i> ä¾èµ–å…³ç³»åˆ†æ</h3>
                            <div id="dependenciesAnalysis">
                                <!-- å°†ç”±JavaScriptå¡«å…… -->
                            </div>
                        </div>
                        
                        <!-- æŠ€æœ¯æ ˆåˆ†æ -->
                        <div class="analysis-section">
                            <h3><i class="fas fa-layer-group"></i> æŠ€æœ¯æ ˆåˆ†æ</h3>
                            <div id="technologyStackAnalysis">
                                <!-- å°†ç”±JavaScriptå¡«å…… -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è¯¦ç»†ä¿¡æ¯åŒºåŸŸ -->
                <div class="detail-sections">
                    <!-- ä»£ç å¤æ‚åº¦åˆ†æ -->
                    <div class="detail-section">
                        <h3><i class="fas fa-calculator"></i> ä»£ç å¤æ‚åº¦åˆ†æ</h3>
                        <div id="complexityAnalysis">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>

                    <!-- æ¶æ„åˆ†æ -->
                    <div class="detail-section">
                        <h3><i class="fas fa-sitemap"></i> æ¶æ„åˆ†æ</h3>
                        <div id="architectureAnalysis">
                            <!-- åŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>

                <!-- æ€§èƒ½åˆ†æ -->
                <div class="detail-section">
                    <h3><i class="fas fa-tachometer-alt"></i> æ€§èƒ½åˆ†æ</h3>
                    <div class="performance-metrics" id="performanceAnalysis">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- æ”¹è¿›å»ºè®® -->
                <div class="detail-section">
                    <h3><i class="fas fa-lightbulb"></i> AIæ”¹è¿›å»ºè®®</h3>
                    <ul class="suggestions-list" id="improvementSuggestions">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </ul>
                </div>

                <!-- AIæ·±åº¦æŠ¥å‘Š -->
                <div class="ai-report-section">
                    <h2><i class="fas fa-brain"></i> AIæ·±åº¦åˆ†ææŠ¥å‘Š</h2>
                    <div class="ai-report-content">
                        <pre id="aiReportContent">æ­£åœ¨ç”ŸæˆAIæ·±åº¦åˆ†ææŠ¥å‘Š...</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', initializeDeepAnalysis);

        function initializeDeepAnalysis() {
            const loading = document.getElementById('loading');
            const mainContent = document.getElementById('mainContent');

            try {
                // æ£€æŸ¥æ˜¯å¦æœ‰æ·±åº¦åˆ†ææ•°æ®
                const deepAnalysisResult = localStorage.getItem('deepAnalysisResult');
                const fileName = localStorage.getItem('fileName');
                const deepAiReport = localStorage.getItem('deepAiReport');

                if (!deepAnalysisResult || !deepAiReport) {
                    showError('æœªæ‰¾åˆ°æ·±åº¦åˆ†ææ•°æ®ï¼Œè¯·è¿”å›é‡æ–°åˆ†æ');
                    return;
                }

                // è§£æåˆ†æç»“æœ
                const analysisData = JSON.parse(deepAnalysisResult);
                
                // å¡«å……é¡µé¢å†…å®¹
                populatePage(analysisData, deepAiReport, fileName);

                // æ˜¾ç¤ºä¸»è¦å†…å®¹
                loading.style.display = 'none';
                mainContent.style.display = 'block';

            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                showError('åŠ è½½åˆ†ææ•°æ®å¤±è´¥: ' + error.message);
            }
        }

        function populatePage(analysisData, aiReport, fileName) {
            // è®¾ç½®æ–‡ä»¶å
            document.getElementById('fileName').textContent = fileName || 'æœªçŸ¥æ–‡ä»¶';

            // ç”Ÿæˆæ¦‚è§ˆå¡ç‰‡
            generateOverviewCards(analysisData);

            // ç”ŸæˆCodeAnalysisAgentä¸“å±åˆ†æ
            generateCodeAnalysisAgentData(analysisData);

            // ç”Ÿæˆå¤æ‚åº¦åˆ†æ
            generateComplexityAnalysis(analysisData);

            // ç”Ÿæˆæ¶æ„åˆ†æ
            generateArchitectureAnalysis(analysisData);

            // ç”Ÿæˆæ€§èƒ½åˆ†æ
            generatePerformanceAnalysis(analysisData);

            // ç”Ÿæˆæ”¹è¿›å»ºè®®
            generateImprovementSuggestions(analysisData);

            // è®¾ç½®AIæŠ¥å‘Š
            document.getElementById('aiReportContent').textContent = aiReport;
        }

        function generateCodeAnalysisAgentData(data) {
            const deepAnalysis = data.deep_analysis || {};
            
            // ç”Ÿæˆé¡¹ç›®æ„å›¾åˆ†æ
            generateProjectIntentAnalysis(deepAnalysis);
            
            // ç”Ÿæˆé¡¹ç›®ç»“æ„åˆ†æ
            generateProjectStructureAnalysis(deepAnalysis);
            
            // ç”Ÿæˆä¾èµ–å…³ç³»åˆ†æ
            generateDependenciesAnalysis(deepAnalysis);
            
            // ç”ŸæˆæŠ€æœ¯æ ˆåˆ†æ
            generateTechnologyStackAnalysis(deepAnalysis);
        }

        function generateProjectIntentAnalysis(deepAnalysis) {
            const projectIntent = deepAnalysis.project_intent || {};
            const intentDiv = document.getElementById('projectIntentAnalysis');
            
            const intentItems = [
                {
                    label: 'é¡¹ç›®ç›®çš„',
                    value: projectIntent.purpose || 'æ•°æ®å¤„ç†æˆ–åˆ†æé¡¹ç›®'
                },
                {
                    label: 'é¡¹ç›®ç±»å‹',
                    value: projectIntent.project_type || 'application'
                },
                {
                    label: 'æ¶æ„é£æ ¼',
                    value: projectIntent.architecture || 'æ¨¡å—åŒ–æ¶æ„'
                },
                {
                    label: 'å¤æ‚åº¦ç­‰çº§',
                    value: projectIntent.complexity || 'é€‚ä¸­'
                },
                {
                    label: 'å¼€å‘é˜¶æ®µ',
                    value: projectIntent.development_stage || 'ç¨³å®šæœŸ'
                },
                {
                    label: 'ä¸»è¦åŠŸèƒ½',
                    value: projectIntent.functionality || 'ä»£ç åˆ†æå’Œå¤„ç†'
                }
            ];
            
            intentDiv.innerHTML = intentItems.map(item => `
                <div class="analysis-item">
                    <div class="analysis-item-label">${item.label}</div>
                    <div class="analysis-item-value">${item.value}</div>
                </div>
            `).join('');
        }

        function generateProjectStructureAnalysis(deepAnalysis) {
            const projectStructure = deepAnalysis.project_structure || {};
            const structureDiv = document.getElementById('projectStructureAnalysis');
            const metricsDiv = document.getElementById('structureMetrics');
            
            const structureItems = [
                {
                    label: 'æ–‡ä»¶ç»„ç»‡ç»“æ„',
                    value: projectStructure.file_organization || 'å•ä¸€æ–‡ä»¶ç»“æ„'
                },
                {
                    label: 'ä»£ç åˆ†å±‚',
                    value: projectStructure.code_layering || 'åŠŸèƒ½æ¨¡å—åŒ–'
                },
                {
                    label: 'è®¾è®¡æ¨¡å¼',
                    value: (projectStructure.design_patterns || ['æ¨¡å—åŒ–']).join(', ')
                },
                {
                    label: 'å‘½åè§„èŒƒ',
                    value: projectStructure.naming_conventions || 'Pythonæ ‡å‡†å‘½å'
                }
            ];
            
            structureDiv.innerHTML = structureItems.map(item => `
                <div class="analysis-item">
                    <div class="analysis-item-label">${item.label}</div>
                    <div class="analysis-item-value">${item.value}</div>
                </div>
            `).join('');
            
            // ç”Ÿæˆç»“æ„æŒ‡æ ‡å¡ç‰‡
            const metrics = [
                {
                    label: 'ä»£ç è¡Œæ•°',
                    value: projectStructure.total_lines || 0
                },
                {
                    label: 'å‡½æ•°æ•°é‡',
                    value: projectStructure.total_functions || 0
                },
                {
                    label: 'ç±»æ•°é‡',
                    value: projectStructure.total_classes || 0
                },
                {
                    label: 'æ–‡ä»¶æ•°é‡',
                    value: projectStructure.total_files || 1
                }
            ];
            
            metricsDiv.innerHTML = metrics.map(metric => `
                <div class="metric-item">
                    <div class="metric-value">${metric.value}</div>
                    <div class="metric-label">${metric.label}</div>
                </div>
            `).join('');
        }

        function generateDependenciesAnalysis(deepAnalysis) {
            const dependencies = deepAnalysis.dependencies || {};
            const depDiv = document.getElementById('dependenciesAnalysis');
            
            const pythonPackages = dependencies.python_packages || [];
            const externalLibs = dependencies.external_libraries || [];
            const versions = dependencies.versions || {};
            
            const dependenciesItems = [
                {
                    label: 'Pythonæ ‡å‡†åº“ä¾èµ–',
                    value: dependencies.std_lib_deps ? Object.keys(dependencies.std_lib_deps).join(', ') : 'os, sys, json'
                },
                {
                    label: 'ç¬¬ä¸‰æ–¹åŒ…',
                    value: pythonPackages.length > 0 ? pythonPackages.join(', ') : 'æ— å¤–éƒ¨ä¾èµ–'
                },
                {
                    label: 'å¤–éƒ¨åº“',
                    value: externalLibs.length > 0 ? externalLibs.join(', ') : 'æ— å¤–éƒ¨åº“'
                },
                {
                    label: 'å¯¼å…¥æ•°é‡',
                    value: dependencies.total_imports || 0
                },
                {
                    label: 'ä¾èµ–å¤æ‚åº¦',
                    value: dependencies.complexity || 'ä½'
                }
            ];
            
            depDiv.innerHTML = dependenciesItems.map(item => `
                <div class="analysis-item">
                    <div class="analysis-item-label">${item.label}</div>
                    <div class="analysis-item-value">${item.value}</div>
                </div>
            `).join('');
        }

        function generateTechnologyStackAnalysis(deepAnalysis) {
            const projectIntent = deepAnalysis.project_intent || {};
            const techDiv = document.getElementById('technologyStackAnalysis');
            
            const techStack = projectIntent.technology_stack || ['Python'];
            const programmingLang = projectIntent.programming_language || 'Python';
            
            const technologyItems = [
                {
                    label: 'ç¼–ç¨‹è¯­è¨€',
                    value: programmingLang
                },
                {
                    label: 'æŠ€æœ¯æ ˆ',
                    value: techStack.join(', ')
                },
                {
                    label: 'æ¡†æ¶ç‰ˆæœ¬',
                    value: projectIntent.framework_version || 'Python 3.x'
                },
                {
                    label: 'å¼€å‘å·¥å…·',
                    value: projectIntent.development_tools || 'æ ‡å‡†IDE'
                },
                {
                    label: 'è¿è¡Œæ—¶ç¯å¢ƒ',
                    value: projectIntent.runtime_environment || 'Pythonè§£é‡Šå™¨'
                },
                {
                    label: 'æ„å»ºå·¥å…·',
                    value: projectIntent.build_tools || 'æ ‡å‡†Pythonå·¥å…·'
                }
            ];
            
            techDiv.innerHTML = technologyItems.map(item => `
                <div class="analysis-item">
                    <div class="analysis-item-label">${item.label}</div>
                    <div class="analysis-item-value">${item.value}</div>
                </div>
            `).join('');
        }

        function generateOverviewCards(data) {
            const overviewCards = document.getElementById('overviewCards');
            
            const cards = [
                {
                    icon: 'fas fa-file-code',
                    title: 'åˆ†ææ–‡ä»¶',
                    value: data.files_analyzed || 0,
                    label: 'æ–‡ä»¶',
                    color: '#667eea'
                },
                {
                    icon: 'fas fa-exclamation-triangle',
                    title: 'å‘ç°é—®é¢˜',
                    value: data.issues_found || 0,
                    label: 'é—®é¢˜',
                    color: '#f093fb'
                },
                {
                    icon: 'fas fa-check-circle',
                    title: 'è´¨é‡è¯„åˆ†',
                    value: data.deep_analysis?.code_quality_report?.quality_score || 'N/A',
                    label: 'åˆ†',
                    color: '#4facfe'
                },
                {
                    icon: 'fas fa-clock',
                    title: 'åˆ†æè€—æ—¶',
                    value: data.took ? Math.round(data.took) : 'N/A',
                    label: 'ç§’',
                    color: '#43e97b'
                }
            ];

            overviewCards.innerHTML = cards.map(card => `
                <div class="overview-card" style="background: linear-gradient(135deg, ${card.color} 0%, ${adjustColor(card.color, -20)} 100%);">
                    <i class="${card.icon}"></i>
                    <div class="value">${card.value}</div>
                    <div class="title">${card.title}</div>
                    <div class="label">${card.label}</div>
                </div>
            `).join('');
        }

        function generateComplexityAnalysis(data) {
            const complexityDiv = document.getElementById('complexityAnalysis');
            const deepAnalysis = data.deep_analysis || {};
            
            const complexityItems = [
                {
                    label: 'ç®—æ³•å¤æ‚åº¦',
                    value: deepAnalysis.performance_analysis?.algorithm_complexity || 'O(n)',
                    level: 'medium'
                },
                {
                    label: 'å†…å­˜å ç”¨',
                    value: deepAnalysis.performance_analysis?.memory_usage || 'ä½',
                    level: 'low'
                },
                {
                    label: 'ä»£ç è¡Œæ•°',
                    value: data.analysis_results?.[0]?.lines || 0,
                    level: data.analysis_results?.[0]?.lines > 500 ? 'high' : 'medium'
                },
                {
                    label: 'å‡½æ•°å¤æ‚åº¦',
                    value: 'é€‚ä¸­',
                    level: 'medium'
                }
            ];

            complexityDiv.innerHTML = complexityItems.map(item => `
                <div class="complexity-item">
                    <span class="complexity-label">${item.label}</span>
                    <span class="complexity-value complexity-${item.level}">${item.value}</span>
                </div>
            `).join('');
        }

        function generateArchitectureAnalysis(data) {
            const architectureDiv = document.getElementById('architectureAnalysis');
            const deepAnalysis = data.deep_analysis || {};
            
            const architectureItems = [
                {
                    title: 'æ¶æ„é£æ ¼',
                    description: deepAnalysis.architecture_assessment?.architecture_style || 'æ¨¡å—åŒ–æ¶æ„'
                },
                {
                    title: 'è€¦åˆç¨‹åº¦',
                    description: deepAnalysis.architecture_assessment?.coupling_level || 'ä½è€¦åˆ'
                },
                {
                    title: 'å†…èšç¨‹åº¦',
                    description: deepAnalysis.architecture_assessment?.cohesion_level || 'é«˜å†…èš'
                },
                {
                    title: 'è®¾è®¡æ¨¡å¼',
                    description: (deepAnalysis.architecture_assessment?.design_patterns || []).join(', ') || 'æ— ç‰¹å®šæ¨¡å¼'
                },
                {
                    title: 'å¯æ‰©å±•æ€§',
                    description: deepAnalysis.architecture_assessment?.extensibility || 'æ˜“äºæ‰©å±•'
                }
            ];

            architectureDiv.innerHTML = architectureItems.map(item => `
                <div class="architecture-item">
                    <div class="title">${item.title}</div>
                    <div class="description">${item.description}</div>
                </div>
            `).join('');
        }

        function generatePerformanceAnalysis(data) {
            const performanceDiv = document.getElementById('performanceAnalysis');
            const deepAnalysis = data.deep_analysis || {};
            
            const metrics = [
                {
                    label: 'æ€§èƒ½è¯„åˆ†',
                    score: deepAnalysis.performance_analysis?.performance_score || 85
                },
                {
                    label: 'å†…å­˜æ•ˆç‡',
                    score: 78
                },
                {
                    label: 'æ‰§è¡Œæ•ˆç‡',
                    score: 92
                },
                {
                    label: 'ä»£ç è´¨é‡',
                    score: deepAnalysis.code_quality_report?.quality_score || 85
                }
            ];

            performanceDiv.innerHTML = metrics.map(metric => `
                <div class="metric-card">
                    <div class="score">${metric.score}</div>
                    <div class="label">${metric.label}</div>
                </div>
            `).join('');
        }

        function generateImprovementSuggestions(data) {
            const suggestionsDiv = document.getElementById('improvementSuggestions');
            const deepAnalysis = data.deep_analysis || {};
            
            const suggestions = [
                ...(deepAnalysis.ai_insights?.improvement_suggestions || []),
                ...(deepAnalysis.code_quality_report?.recommendations || []),
                ...(deepAnalysis.performance_analysis?.optimization_opportunities || [])
            ];

            if (suggestions.length === 0) {
                suggestions.push('ä»£ç è´¨é‡è‰¯å¥½ï¼Œå»ºè®®ä¿æŒç°æœ‰æ ‡å‡†');
            }

            suggestionsDiv.innerHTML = suggestions.slice(0, 6).map(suggestion => `
                <li>
                    <i class="fas fa-lightbulb"></i>
                    <span>${suggestion}</span>
                </li>
            `).join('');
        }

        function downloadReport() {
            // å®ç°ä¸‹è½½åŠŸèƒ½
            const reportData = {
                fileName: localStorage.getItem('fileName'),
                analysisResult: JSON.parse(localStorage.getItem('deepAnalysisResult')),
                aiReport: localStorage.getItem('deepAiReport')
            };
            
            const blob = new Blob([JSON.stringify(reportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${reportData.fileName}_deep_analysis_report.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function viewRawData() {
            const data = JSON.parse(localStorage.getItem('deepAnalysisResult'));
            alert('åŸå§‹æ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            navigator.clipboard.writeText(JSON.stringify(data, null, 2));
        }

        function adjustColor(color, amount) {
            // ç®€å•çš„é¢œè‰²è°ƒæ•´å‡½æ•°
            return color;
        }

        function showError(message) {
            const loading = document.getElementById('loading');
            loading.innerHTML = `
                <div style="color: #dc3545; font-size: 1.2em;">
                    <i class="fas fa-exclamation-triangle"></i> ${message}
                </div>
                <a href="index.html" style="margin-top: 20px; display: inline-block; color: #4facfe; text-decoration: none;">
                    <i class="fas fa-arrow-left"></i> è¿”å›é‡æ–°åˆ†æ
                </a>
            `;
        }
    </script>
</body>
</html>

